///////////////////////////////////////////////////////////
//  SQLConfig.h
//  Implementation of the Class SQLConfig
//  Created on:      22-五月-2015 10:35:01
//  Original author: Administrator
///////////////////////////////////////////////////////////

#if !defined(SQLCONFIG_H_)
#define SQLCONFIG_H_

#include <string>

namespace uc {

using namespace std;

////////////////////////数据库定义///////////////////////////
const string HISTORY_ACCOUNT = "TBL_HISTORY_ACCOUNT";
const string CREATE_HISTORY_ACCOUNT = "CREATE TABLE IF NOT EXISTS TBL_HISTORY_ACCOUNT ("
	"USER_ACCOUNT VARCHAR PRIMARY KEY NOT NULL, "
	"DISPLAY_NAME VARCHAR NOT NULL, "
	"LOCAL_AVATAR VARCHAR NOT NULL DEFAULT '', "
	"LOGIN_TIME BIGINT NOT NULL DEFAULT 0, "
	"PASSWORD VARCHAR, "
	"LAST_MANUAL_LOGIN_TIME BIGINT NOT NULL DEFAULT 0, "
	"RECORD_PWD BOOLEAN DEFAULT 0, "
	"AUTO_LOGIN BOOLEAN DEFAULT 0,"
	"ACCOUNT_TYPE INT NOT NULL DEFAULT 1"
	");";

const string PROXY_AUTH_INFO = "TBL_PROXY_AUTH_INFO";
const string CREATE_PROXY_AUTH_INFO = "CREATE TABLE IF NOT EXISTS TBL_PROXY_AUTH_INFO ("
	"PROXY_URL VARCHAR PRIMARY KEY NOT NULL, "
	"TYPE TINYINT NOT NULL DEFAULT 0, "
	"USER_ACCOUNT VARCHAR NOT NULL DEFAULT '', "
	"PASSWORD VARCHAR NOT NULL DEFAULT '' "
	");";

const string COMMON_CONFIG = "TBL_COMMON_CONFIG";
const string CREATE_COMMON_CONFIG = "CREATE TABLE IF NOT EXISTS TBL_COMMON_CONFIG ("
"APPLICATION VARCHAR NOT NULL, "
"CFG_NAME VARCHAR NOT NULL, "
"CFG_VALUE VARCHAR NOT NULL DEFAULT '', "
"PRIMARY KEY (APPLICATION, CFG_NAME) "
");";

////////////////////////////////////////////////////////
const string CONTACT = "TBL_CONTACT";
const string CREATE_CONTACT = "CREATE TABLE IF NOT EXISTS TBL_CONTACT ("
	"USER_ID INTEGER NOT NULL, "
	"USER_ACCOUNT VARCHAR NOT NULL, "
	"DISPLAY_NAME VARCHAR NOT NULL DEFAULT '', "
	"DISPLAY_EN VARCHAR NOT NULL DEFAULT '', "
	"SEX INTEGER NOT NULL DEFAULT 0, "
	"DEPT_ID INTEGER NOT NULL DEFAULT 0, "
	"DEPT_NAME VARCHAR NOT NULL DEFAULT '', "
	"POSITION VARCHAR NOT NULL DEFAULT '', "
	"WORK_PHONE VARCHAR NOT NULL DEFAULT '', "
	"MOBILE VARCHAR NOT NULL DEFAULT '', "
	"EMAIL VARCHAR NOT NULL DEFAULT '', "
	"SUPERIOR_ID INTEGER NOT NULL DEFAULT 0, "
	"SUPERIOR_NAME VARCHAR NOT NULL DEFAULT '', "
	"SITE_ID INTEGER NOT NULL DEFAULT 0, "
	"PERSONAL_SIGN VARCHAR NOT NULL DEFAULT '', "
	"AVATAR_URL VARCHAR NOT NULL DEFAULT '', "
	"TYPE INTEGER NOT NULL, "
	"FELLOW_NUM INTEGER NOT NULL DEFAULT 0, "
	"CARD_VERSION BIGINT NOT NULL DEFAULT 0, "
	"LAST_UPDATE_TIME BIGINT NOT NULL DEFAULT 0, "
	"USER_TAGS TEXT NOT NULL DEFAULT '', "
	"PRIMARY KEY (USER_ID ASC) ON CONFLICT REPLACE, "
	"CONSTRAINT UK_USER_ACCOUNT UNIQUE (USER_ACCOUNT ASC) ON CONFLICT REPLACE"
	");"
	"CREATE UNIQUE INDEX INDEX_USER_ACCOUNT ON TBL_CONTACT (USER_ACCOUNT ASC);"
	"CREATE UNIQUE INDEX INDEX_USER_ID ON TBL_CONTACT (USER_ID ASC);"
	"CREATE INDEX INDEX_USER_NAME ON TBL_CONTACT (DISPLAY_EN ASC);"
	"CREATE INDEX INDEX_TYPE ON TBL_CONTACT(TYPE);";

const string CONFIG = "TBL_CLIENT_CONFIG";
const string CREATE_CONFIG = "CREATE TABLE IF NOT EXISTS TBL_CLIENT_CONFIG ("
	"APPLICATION VARCHAR NOT NULL, "
	"CFG_NAME VARCHAR NOT NULL, "
	"CFG_VALUE VARCHAR NOT NULL DEFAULT '', "
	"PRIMARY KEY (APPLICATION, CFG_NAME) "
	");";

const string GROUP = "TBL_DISCUSSION_GROUP";
const string CREATE_GROUP = "CREATE TABLE IF NOT EXISTS TBL_DISCUSSION_GROUP ("
	"GROUP_ID BIGINT NOT NULL, "
	"GROUP_NAME VARCHAR NOT NULL DEFAULT '', "
	"GROUP_NAME_EN VARCHAR NOT NULL DEFAULT '', "
	"AVATAR_URL VARCHAR DEFAULT '', "
	"LOCAL_AVATAR_URL VARCHAR DEFAULT '', "
	"JOIN_STATE INTEGER NOT NULL, "
	"CREATE_TIME BIGINT NOT NULL DEFAULT 0, "
	"MEMBER_COUNT INTEGER NOT NULL DEFAULT 0, "
	"SITE_ID INTEGER NOT NULL DEFAULT 0, "
	"IS_TOP INTEGER NOT NULL DEFAULT 0, "
	"NAME_FLAG INTEGER NOT NULL DEFAULT 0, "
	"IS_DISPLAY INTEGER NOT NULL DEFAULT 0, "
	"MEMBER_TYPE INTEGER NOT NULL DEFAULT 0, "
	"MSG_NOT_DISTURB INTEGER NOT NULL DEFAULT 0, "
	"STATE INTEGER NOT NULL DEFAULT 0, "
	"ADMIN_ID INTEGER NOT NULL DEFAULT 0, "
	"MOUNT_ID INTEGER NOT NULL DEFAULT 0, "
	"EXTERNAL_ID VARCHAR DEFAULT '', "
	"ALERT_SWITCH INTEGER NOT NULL DEFAULT 0, "
	"ALERT_RULE INTEGER NOT NULL DEFAULT 0, "
	"ALERT_TIME BIGINT NOT NULL DEFAULT 0, "
	"MODIFY_TIME  BIGINT,"
	"STATUS_INFO VARCHAR NOT NULL DEFAULT '',"
	"PRIMARY KEY (GROUP_ID ASC) ON CONFLICT REPLACE "
	");"
	"CREATE INDEX INDEX_GROUP_EN ON TBL_DISCUSSION_GROUP (GROUP_NAME_EN ASC); "
	"CREATE UNIQUE INDEX INDEX_GROUP_ID ON TBL_DISCUSSION_GROUP (GROUP_ID DESC);";

const string GROUP_MEMBER = "TBL_GROUP_MEMBER_RELATION";
const string CREATE_GROUP_MEMBER = "CREATE TABLE TBL_GROUP_MEMBER_RELATION ("
	"GROUP_ID BIGINT NOT NULL DEFAULT 0, "
	"USER_ID INTEGER NOT NULL DEFAULT 0, "
	"JOIN_TIME INTEGER NOT NULL DEFAULT 0, "
	"CONSTRAINT FK_GRPMEM_GRPID FOREIGN KEY (GROUP_ID) REFERENCES TBL_DISCUSSION_GROUP (GROUP_ID) ON DELETE CASCADE, "
	"CONSTRAINT UK_GRP_MEMBER UNIQUE (GROUP_ID ASC, USER_ID ASC)"
	");";

const string MESSAGE = "TBL_MESSAGE";
const string CREATE_MESSAGE = "CREATE TABLE IF NOT EXISTS TBL_MESSAGE ("
	"MSG_ID INTEGER NOT NULL, "
	"MSG_SEQ BIGINT NOT NULL DEFAULT 0, "
	"MSG_TIME BIGINT NOT NULL, "
	"SEND_STATE TINYINT NOT NULL, "
	"PLAY_STATE TINYINT NOT NULL, "
	"MSG_CONTENT VARCHAR NOT NULL, "
	"APP_ID INTEGER NOT NULL, "
	"PROTOCOL_TYPE INTEGER NOT NULL, "
	"PROTOCOL_ID INTEGER NOT NULL, "
	"PRI INTEGER NOT NULL,"
	"CONTROL_PRI INTEGER NOT NULL DEFAULT 0,"
	"CHANNEL_PRI INTEGER NOT NULL DEFAULT 0,"
	"CONVERSATION INTEGER NOT NULL, "
	"FROM_ID INTEGER NOT NULL, "
	"FROM_SITE_ID INTEGER NOT NULL, "
	"FROM_RES_ID INTEGER NOT NULL, "
	"TO_ID INTEGER NOT NULL, "
	"TO_SITE_ID INTEGER NOT NULL DEFAULT 0, "
	"TO_RES_ID INTEGER NOT NULL DEFAULT 0, "
	"TO_PRIVATE_ID INTEGER NOT NULL,"
	"TO_PRIVATE_SITE_ID INTEGER NOT NULL,"
	"TO_PRIVATE_RES_ID INTEGER NOT NULL,"
	"VERSION INTEGER NOT NULL, "
	"CONVERSATION_TYPE INT NOT NULL, "
	"RELATE_ID BIGINT NOT NULL, "
	"FLAG INTEGER NOT NULL DEFAULT 0, "
	"OA_LAST_STATUS INTEGER NOT NULL DEFAULT -1, "
	"APP_ACK_SENT INTEGER NOT NULL DEFAULT 1, "
	"OA_EXTERNAL_DATA VARCHAR NOT NULL, "
	"MSG_AT_USERS TEXT NOT NULL DEFAULT '', "
	"PRIMARY KEY (CONVERSATION_TYPE, RELATE_ID, MSG_SEQ) ON CONFLICT REPLACE "
	");"
	"CREATE INDEX INDEX_MSG_ID ON TBL_MESSAGE (MSG_ID);"
	"CREATE INDEX INDEX_MSG_SEQ ON TBL_MESSAGE (MSG_SEQ DESC);"
	"CREATE INDEX INDEX_MSG_TIME ON TBL_MESSAGE (MSG_TIME DESC);";

const string CONVERSATION = "TBL_CONVERSATION";
const string CREATE_CONVERSATION = "CREATE TABLE TBL_CONVERSATION ("
	"CONVERSATION_TYPE INTEGER NOT NULL, "
	"RELATE_ID BIGINT NOT NULL, "
	"HIDDEN BOOLEAN NOT NULL DEFAULT 0, "
	"NEWMSG_NUM INTEGER NOT NULL DEFAULT 0, "
	"MSG_ID INTEGER NOT NULL DEFAULT 0, "
	"MSG_SEQ BIGINT NOT NULL DEFAULT 0, "
	"MSG_TIME BIGINT NOT NULL DEFAULT 0, "
	"SEND_STATE TINYINT NOT NULL DEFAULT 0, "
	"MSG_CONTENT VARCHAR NOT NULL DEFAULT '', "
	"APP_ID INTEGER NOT NULL DEFAULT 0, "
	"PROTOCOL_TYPE INTEGER NOT NULL DEFAULT 0, "
	"PROTOCOL_ID INTEGER NOT NULL DEFAULT 0, "
	"CONVERSATION INTEGER NOT NULL DEFAULT 0, "
	"FROM_ID INTEGER NOT NULL DEFAULT 0, "
	"FROM_SITE_ID INTEGER NOT NULL DEFAULT 0, "
	"FROM_RES_ID INTEGER NOT NULL DEFAULT 0, "
	"TO_ID INTEGER NOT NULL DEFAULT 0, "
	"TO_SITE_ID INTEGER NOT NULL DEFAULT 0, "
	"TO_RES_ID INTEGER NOT NULL DEFAULT 0, "
	"VERSION INTEGER NOT NULL DEFAULT 0, "
	"OA_LAST_STATUS INTEGER NOT NULL DEFAULT -1, "
	"APP_ACK_SENT INTEGER NOT NULL DEFAULT 1, "
	"PRIMARY KEY (CONVERSATION_TYPE, RELATE_ID) ON CONFLICT REPLACE "
	");"
	"CREATE INDEX INDEX_UPDATE_MSG_TIME ON TBL_CONVERSATION (MSG_SEQ DESC);";

const string DELCONVERSATION = "TBL_DEL_CONVERSATION";
const string CREATE_DELCONVERSATION = "CREATE TABLE TBL_DEL_CONVERSATION("
	"CONVERSATION_TYPE INTEGER NOT NULL, "
	"RELATE_ID BIGINT NOT NULL, "
	"REMOVE_TIME BIGINT NOT NULL DEFAULT 0, "
	"PRIMARY KEY (CONVERSATION_TYPE, RELATE_ID) ON CONFLICT REPLACE "
	");";


const string CONFERENCE = "TBL_CONFERENCE";
const string CREATE_CONFERENCE = "CREATE TABLE IF NOT EXISTS TBL_CONFERENCE ("
	"EVENT_ID BIGINT NOT NULL, "
	"PARENT_ID BIGINT NOT NULL DEFAULT 0, "
	"START_TIME BIGINT NOT NULL DEFAULT 0, "
	"ORI_TIME BIGINT NOT NULL DEFAULT 0, "
	"AUTHORIZER_ID INTEGER NOT NULL DEFAULT 0, "
	"DURATION INTEGER NOT NULL, "
	"CONF_ID VARCHAR NOT NULL DEFAULT '', "
	"CONF_TITLE VARCHAR NOT NULL DEFAULT '', "
	"CONF_STATUS INTEGER NOT NULL DEFAULT 0, "
	"CONF_SUMMARY TEXT NOT NULL DEFAULT '', "
	"CONF_LOCATION VARCHAR NOT NULL DEFAULT '', "		
	"HOST_ID INTEGER NOT NULL, "
	"HOST_NAME VARCHAR NOT NULL DEFAULT '', "
	"HOST_PWD VARCHAR NOT NULL DEFAULT '', "
	"ATTENDEE_PWD VARCHAR NOT NULL DEFAULT '', "
	"BILLING_CODE VARCHAR NOT NULL DEFAULT '', "
	"RELATE_GRPID BIGINT NOT NULL DEFAULT 0, "
	"TIME_ZONE VARCHAR NOT NULL DEFAULT '', "
	"IS_GNET BOOLEAN NOT NULL DEFAULT 1, "
	"IS_WHOLEDAY BOOLEAN NOT NULL DEFAULT 0, "
	"IS_CYCLE BOOLEAN NOT NULL DEFAULT 0, "
	"REPEAT_TYPE VARCHAR NOT NULL DEFAULT '', "
	"INTERVAL INTEGER NOT NULL DEFAULT 1, "
	"MONTHNO INTEGER NOT NULL DEFAULT 1, "
	"WEEKNO INTEGER NOT NULL DEFAULT 1, "
	"DAYNO INTEGER NOT NULL DEFAULT 1, "
	"WEEKDAYS VARCHAR NOT NULL DEFAULT '', "
	"REPEAT_COUNT INTEGER DEFAULT 0, "
	"REPEAT_ENDDATE BIGINT DEFAULT 0, "
	"LANGUAGE INTEGER NOT NULL DEFAULT 1, "
	"EMAIL_LANGUAGE INTEGER NOT NULL DEFAULT 1, "
	"LAST_UPDATE_TIME BIGINT DEFAULT 0, "
	"IS_OLD BOOLEAN DEFAULT 0, "
	"CONF_EXTRASINFO TEXT NOT NULL DEFAULT '', "
	"ROOM_ID VARCHAR NOT NULL DEFAULT '', "
	"PRIMARY KEY (EVENT_ID, PARENT_ID, AUTHORIZER_ID, ORI_TIME) ON CONFLICT REPLACE "
	");"
	"CREATE INDEX INDEX_ID_EVENT_TIME ON TBL_CONFERENCE(EVENT_ID ASC, START_TIME ASC);"
	"CREATE INDEX INDEX_CONF_TIME ON TBL_CONFERENCE(START_TIME ASC);";

const string CONF_MEMBER = "TBL_CONF_MEMBER_RELATION";
const string CREATE_CONF_MEMBER = "CREATE TABLE IF NOT EXISTS TBL_CONF_MEMBER_RELATION ("
	"EVENT_ID BIGINT NOT NULL, "
	"START_TIME BIGINT NOT NULL DEFAULT 0, "
	"AUTHORIZER_ID INTEGER NOT NULL DEFAULT 0, "
	"USER_ACCOUNT VARCHAR NOT NULL, "
	"USER_NAME VARCHAR NOT NULL DEFAULT '', "
	"USER_TYPE TINYINT NOT NULL DEFAULT 1, "
	"USER_STATUS TINYINT NOT NULL DEFAULT 0 "
	");"
	"CREATE INDEX INDEX_MEMBER_ID_EVENT_TIME ON TBL_CONF_MEMBER_RELATION(EVENT_ID ASC, START_TIME ASC, AUTHORIZER_ID ASC);";

const string SHARE = "TBL_CONF_SHARE_USER";
const string CREATE_SHARE = "CREATE TABLE IF NOT EXISTS TBL_CONF_SHARE_USER ("
	"TYPE INTEGER NOT NULL, "
	"SHARE_USERID INTEGER NOT NULL, "
	"PRIMARY KEY (TYPE, SHARE_USERID) ON CONFLICT REPLACE"
	");";

const string FILETRANSFER = "TBL_FILE_TRANSFER";
const string CREATE_FILETRANSFER = "CREATE TABLE IF NOT EXISTS TBL_FILE_TRANSFER ("
		"FILEURL VARCHAR NOT NULL, "
		"LOCALPATH VARCHAT NOT NULL DEFAULT '',"
		"PRIMARY KEY (FILEURL) ON CONFLICT REPLACE"
		");";

const string FILETRANSFER1 = "TBL_FILE_TRANSFER1";
const string CREATE_FILETRANSFER1 = "CREATE TABLE IF NOT EXISTS TBL_FILE_TRANSFER1 ("
"FILEURL VARCHAR NOT NULL, "
"LOCALPATH VARCHAT NOT NULL DEFAULT '',"
"FILE_SIZE BIGINT NOT NULL DEFAULT 0,"
"PRIMARY KEY (FILEURL) ON CONFLICT REPLACE"
");";

const string KEYVALUE = "TBL_KEY_VALUE";
const string CREATE_KEYVALUE = "CREATE TABLE IF NOT EXISTS TBL_KEY_VALUE ("
"APPLICATION VARCHAR NOT NULL, "
"CFG_NAME VARCHAR NOT NULL, "
"CFG_VALUE TEXT NOT NULL DEFAULT '', "
"PRIMARY KEY (APPLICATION, CFG_NAME) "
");";

const string CALL_PHONENUM = "TBL_CALL_PHONENUM";
const string CREATE_CALL_PHONENUM = "CREATE TABLE IF NOT EXISTS TBL_CALL_PHONENUM ("
"PHONE_NUMBER VARCHAR NOT NULL, "
"CALL_TIME BIGINT NOT NULL DEFAULT 0, "
"PRIMARY KEY (PHONE_NUMBER) "
");";

const string DROP_CHANGED_TABLES = "DROP TABLE IF EXISTS TBL_CONTACT;"
		"DROP TABLE IF EXISTS TBL_CONTACT_TAGS;"
		"DROP TABLE IF EXISTS TBL_CONTACT_TAGS;"
		"DROP TABLE IF EXISTS TBL_DISCUSSION_GROUP;"
		"DROP TABLE IF EXISTS TBL_GROUP_MEMBER_RELATION;"
		"DROP TABLE IF EXISTS TBL_MESSAGE;"
		"DROP TABLE IF EXISTS TBL_CONVERSATION;"
		"DROP TABLE IF EXISTS TBL_CONFERENCE;"
		"DROP TABLE IF EXISTS TBL_CONF_MEMBER_RELATION;"
		"DROP TABLE IF EXISTS TBL_CONF_SHARE_USER;"
		"DROP TABLE IF EXISTS TBL_FILE_TRANSFER;"
		"DROP TABLE IF EXISTS TBL_CALL_PHONENUM;"
		;

////////////////////////外部数据库定义///////////////////////////
const string EXTERNAL_MESSAGE = "TAB_CHATMSG";

}


////////////////////////PBX 数据库定义///////////////////////////

const std::string TABNAME_PBXCONFIG = "TAB_CONFIG";
const std::string CREATE_PBXCONFIG = "CREATE TABLE IF NOT EXISTS TAB_CONFIG ("
"  application VARCHAR(255) NOT NULL,"
"  app_name VARCHAR(255) NOT NULL,"
"  app_value VARCHAR(255) NOT NULL,"
"  PRIMARY KEY (application, app_name)"
")";

const std::string TABNAME_PBXCALLRECORD = "TAB_PBXCALLRECORD";
const std::string CREATE_PBXCALLRECORD = "CREATE TABLE IF NOT EXISTS TAB_PBXCALLRECORD ("
"  OPERATE_TIME BIGINT NOT NULL,"
"  CALLID INTEGER NOT NULL,"
"  NAME VARCHAR(255) NOT NULL,"
"  NUMBER VARCHAR(20) NOT NULL,"
"  STATE INTEGER NOT NULL,"
"  USERID INTEGER DEFAULT 0,"
"  TYPE INTEGER DEFAULT 0,"
"  DRUATION INTEGER DEFAULT 0,"
"  PRIMARY KEY (OPERATE_TIME, CALLID)"
")";

#endif // !defined(SQLCONFIG_H_)
